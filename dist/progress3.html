<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<!--Reconfigurable base tag; used to modify the site root location for root-relative links-->
<!--<base href="https://engineering.purdue.edu/ece477/StudentWebTemplate/" />-->
    <base href="https://engineering.purdue.edu/477grp2/" /> <!-- Replace the N with your team number-->

<!--Content-->
<title>ECE477 Course Documents</title>

</head>
<style>
	html {
		background: white;
	}

	.instructions {
		color: orange;
	}

	.progress {
		color: green;
	}

	.references {
		color: blue;
	}

	.issues {
		color: red;
	}

	.think {
		color: palevioletred;
	}

	.todo {
		color: brown;
	}

	.visualCaption {
		position: relative;
		left: 20px;
		color: purple;
		font-style: italic;
	}

	.picture {
		max-width: 700px;
		max-height: 700px;
	}

	hr {
		display: block !important;
		height: 2px;
		background: black;
	}
</style>

<body>
<div id="wrapper_site">
	<div id="header"></div>
		<div id="content">
            <h2>Progress Report/Engineering Project Journal for Matthew Ghera</h2>

			key: 
			<ul>
				<li class="instructions">
					instructions
				</li>
				<li class="progress">
					progress
				</li>
				<li class="references">
					references
				</li>
				<li class="issues">
					issues
				</li>
				<li class="think">
					things to think about and consider
				</li>
				<li class="todo">
					todo
				</li>
				<li class="visualCaption" style="left:0px;">
					visual caption
				</li>
			</ul>
			<br>

			<h4>Total time spent: 72.25 hours</h4>
            
			<hr>
			<br>

			<h1>WEEK 7</h1>
			<h4>Time spent this week: 11</h4>
			<hr>

			<b>Date Reported:</b> 2/11/24<br>
            <b>Start Time:</b> 3:30 PM<br>
            <b>Work Time:</b> 2 hours<br>
			<ul class="progress">
				<li>I worked on routing all the auxiliary circuits to the micro. I got a majority of the routes done as can see below.</li>
				<ul>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\pcb222.png" class="picture"></img> 
						<br>
						PCB with some micro routing
					</div>
				</ul>
			</ul>

			<b>Date Reported:</b> 2/18/24<br>
            <b>Start Time:</b> 11:00 PM<br>
            <b>Work Time:</b> 2 hours<br>
			<ul class="progress">
				<li>I worked on the PCB for the Coulumb counter routing which can be seen below.</li>
				<ul>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\PCBCoulumb.png" class="picture"></img> 
						<br>
						Coulumb Counter PCB Routing
					</div>
				</ul>
				<li>I worked on the PCB for the stepper motor control routing and placement which can be seen below.</li>
				<ul>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\PCBStepper.png" class="picture"></img> 
						<br>
						Stepper Motor Control PCB Routing
					</div>
				</ul>
				<li>I worked on the PCB for the DC motor control routing and placement which can be seen below.</li>
				<ul>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\PCBDCMotor.png" class="picture"></img> 
						<br>
						DC Motor Control PCB Routing
					</div>
				</ul>
				<li>I modified the shift register pcb to better match our conventions of directional routes.</li>
				<ul>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\PCBSR.png" class="picture"></img> 
						<br>
						LED Shift Register Daisy Chain PCB Routing
					</div>
				</ul>
			</ul>

			<hr>

			<b>Date Reported:</b> 2/17/24<br>
            <b>Start Time:</b> 10:00 AM<br>
            <b>Work Time:</b> 7 hours<br>
			<ul class="progress">
				<li>I began working on looking into the coulumb counter for monitoring the battery life. After doing a decent amount of research, I stumbled throughout the following four references. Most of the coulumb counters I could find were all rated for under 20v which is problematic because our input voltage is 18.5v. I looked into see if it was okay to put the coulumb counter after out 18.5 to 5v regulator would be okay, but from what I saw online, it seemed like that would not provide an accurate result. So, I continued to look and finally stumbled upon the LTC2944 which allows for a 60v input. This will be the coulumb counter that we will use.</li>
				<ul>
					<li class="references">
						<a href="https://www.ti.com/lit/ds/symlink/bq26231.pdf?ts=1708001370328&ref_url=https%253A%252F%252Fwww.ti.com%252Fproduct%252FBQ26231">bq26231</a>
					</li>
					<li class="references">
						<a href="https://www.analog.com/media/en/technical-documentation/data-sheets/4150fc.pdf">LTC4150</a>
					</li>
					<li class="references">
						<a href="https://www.analog.com/en/products/ltc2943.html">LTC2943</a>
					</li>
					<li class="references">
						<a href="https://www.analog.com/en/products/ltc2944.html">LTC2944</a>
					</li>
				</ul>
				<li>I then added the coulumb counter circuit to the circuit schematic as seen below.</li>
				<ul>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\coulumb.png" class="picture"></img> 
						<br>
						Coulumb Counter Circuit with (LTC2944)
					</div>
				</ul>
				<li>I also modified the circuit schematic for the stepper motor driver to be correct as it was using a 4 wire motor previously.</li>
				<ul>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\stepperSchem.png" class="picture"></img> 
						<br>
						Updated Stepper Motor Circuit Schematic
					</div>
				</ul>
				<li>I then worked on adding footprints to most of the symbols in the circuit schematic (chris already added some of the footprints last week). Along with adding footprints, I compiled a list of all the things to order with their links for Andrew to put on the BOM and so we can do the footprint verification. Below you can see the list.</li>
				<ul>
					--------------------------------------------------------------------------------------------
					<br>
					<ul>
						- Coulumb Counter:
							<ul>
								<li>LTC2944 (x1): Footprint (Done), Purchase link: <a href="http://tinyurl.com/5bm4cecw">here</a></li>
								<li>Resistors (2k) (x3): Footprint (Done), Purchase link: <a href="http://tinyurl.com/5ypmwzyj">here</a></li>
							</ul>
					</ul>
					--------------------------------------------------------------------------------------------
					<br>
					<ul>
						<li>Mounting Holes (x4): Footprint (Done), Purchase link: n/a</li>
					</ul>
					--------------------------------------------------------------------------------------------
					<br>
					<ul>
						- Stepper Motor Driver
						<ul>
							<li>ULN2003APG (x1): Footprint (Done), Purchase link: n/a (using mine since these aren't manufactured anymore)</li>
							<li>Stepper motor (x1): footprint (Done), Purchase link: no need to buy motor, but do need to order connectors: <a href="http://tinyurl.com/me8teh2x">here</a> </li>
							<li>TVS0500DRV (x4): footprint (Done), Purchase link: <a href="http://tinyurl.com/yc6uzus9">here</a></li>
							<li>resistors (200) (x4): footprint (done), purchase link: <a href="http://tinyurl.com/25d3yswp">here</a></li>
						</ul>
					</ul>
					--------------------------------------------------------------------------------------------
					<br>
					<ul>
						- Heartbeart LEDs
						<ul>
							<li>LED (x2): footprint (done), purchase link:  <a href="http://tinyurl.com/yc2cbjae">here</a></li>
							<li>resistor (200) (x1): footprint (done), purchase link: <a href="http://tinyurl.com/25d3yswp">here</a></li>
							<li>resistor (333) (x1): footprint (done), purchase link: <a href="http://tinyurl.com/bdzycr97">here</a></li>
						</ul>
					</ul>
					--------------------------------------------------------------------------------------------
					<br>
					<ul>
						- DC motor drivers
						<ul>
							<li>Motor drivers (x2): footprint (done), purchase link: <a href="http://tinyurl.com/bd5em92n">here</a></li>
							<li>Motor DC (x2): footprint (NOT DONE DONT KNOW WHAT TO DO FOR THIS ONE BC IDK WHAT THE MOTORS ARE), purchase link: n/a</li>
							<li>TVS0500DRV (x8): footprint (Done), Purchase link: <a href="http://tinyurl.com/yc6uzus9">here</a></li>
							<li>Capacitor (0.1uF) (x4): footprint done, purchase link: <a href="http://tinyurl.com/y68vdj92">here</a></li>
							<li>electrolytic Capacitor (10uF) (x4): footprint done, purchase link: <a href="http://tinyurl.com/4b923fwf">here</a></li>
							<li>Resistor (200) (x4): footprint done, purchase link: <a href="http://tinyurl.com/25d3yswp">here</a></li>
						</ul>
					</ul>
					--------------------------------------------------------------------------------------------
					<br>
					<ul>
						- 5-3v3 LDO
						<ul>
							<li>LD1117S33TR-SOT223 (x1): footprint (done), purchase link: <a href="http://tinyurl.com/yntmf7ey">here</a></li>
							<li>electrolytic caps (10uf) (x2): footprint (done), purchase link: <a href="http://tinyurl.com/4b923fwf">here</a></li>
						</ul>
					</ul>
					--------------------------------------------------------------------------------------------
					<br>
					<ul>
						- Shift registers & LEDs
						<ul>
							<li>LED headers (x24): footprint (done), purchase link: <a href="http://tinyurl.com/bdzytrd2">here</a></li>
							<li>shift register (x3): footprint (done), purchase link: <a href="http://tinyurl.com/2rc8ez69">here</a></li>
							<li>resistors (x24): footprint (done), purchase link: <a href="http://tinyurl.com/25d3yswp">here</a></li>
						</ul>
					</ul>	
					--------------------------------------------------------------------------------------------
					<br>
					<ul>
						- PIR sensors
						<ul>
							<li>PIR header (x4): footprint (done), purchase link: <a href="http://tinyurl.com/2knyh9py">here</a></li>
						</ul>
					</ul>
					--------------------------------------------------------------------------------------------
					<br>
					<ul>
						- ESP-WROOM
						<ul>
							<li>capacitors (10uf) (x1): footprint (done), purchase link: <a href="http://tinyurl.com/5eewpnaz">here</a></li>
							<li>capacitors (1uf) (x3): footprint (done), purchase link: <a href="http://tinyurl.com/3r3pnrcf">here</a></li>
							<li>resistors (0) (x1), footprint (done), purchase link: <a href="http://tinyurl.com/ycymc83b">here</a></li>
							<li>resistors (10k) (x1), footprint (done), purchase link: <a href="http://tinyurl.com/mr8e7jfs">here</a></li>
							<li>esp 32 s2 (x1), footprint (done), purchase link: <a href="http://tinyurl.com/28x7v95y">here</a></li>    
						</ul>
					</ul>
					--------------------------------------------------------------------------------------------
					<br>
					<ul>
						- USB to UART
						<ul>
							<li>Resistors (10k) (x3): footprint (done), purchase link: <a href="http://tinyurl.com/mr8e7jfs">here</a></li>
							<li>Resistors (0) (x4), footprint (done): purchase link: <a href="http://tinyurl.com/ycymc83b">here</a></li>
							<li>Resistors (1k) (x1): footprint (done), purchase link: <a href="http://tinyurl.com/3nyphbyr">here</a></li>
							<li>Resistors (47.5k) (x1): footprint (done), purchase link: <a href="http://tinyurl.com/mr3j2f5u">here</a></li>
							<li>Resistors (22.1k) (x1): footprint (done), purchase link: <a href="http://tinyurl.com/28nv7fnn">here</a></li>
							<li>L805QLT1G (x2): footprint (done), purchase link: <a href="http://tinyurl.com/4jbc65hu">here</a></li>
							<li>buttons (x2): footprint (done), purchase link: <a href="http://tinyurl.com/4cvrkwap">here</a></li>
							<li>capacitors (0.1uF) (x2): footprint done, purchase link: <a href="http://tinyurl.com/y68vdj92">here</a></li>
							<li>capacitors (1 uF) (x1): footprint done, purchase link: <a href="http://tinyurl.com/3r3pnrcf">here</a></li>
							<li>capacitors (10 uF) (x2): footprint done, purchase link: <a href="http://tinyurl.com/5eewpnaz">here</a></li>
							<li>usb-b micro (x1): footprint done, purchase link: <a href="http://tinyurl.com/28fzfp38">here</a></li>
							<li>diode (x1): ???, purchase link: </li>
						</ul>
					</ul>	
					--------------------------------------------------------------------------------------------
				</ul>
			</ul>

			<hr>

			<h1>WEEK 6</h1>
			<h4>Time spent this week: 10.5</h4>
			<hr>

			<b>Date Reported:</b> 2/14/24<br>
            <b>Start Time:</b> 3:30 pM<br>
            <b>Work Time:</b> 2.5 hours<br>
			<ul class="progress">
				<li>We got our PIR sensors, so I started prototyping with them.</li>
				<li>Below is the pinout for the PIR sensor (am312) we are using that I used to wire it up.</li>
				<ul>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\PIR4.png" class="picture"></img> 
						<br>
						PIR pinout (am312)
					</div>
				</ul>
				<li>Here is the code for reading in from the PIR sensors and printing out the value using a simple sampling script.</li>
				<ul>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\PIR1.png" class="picture"></img> 
						<br>
						PIR sensor simple code
					</div>
				</ul>
				<li class="issues">I then tried to get the interrupts working with the PIR sensors. However, I was running into issues where the interrupts were not getting called. I checked the config to see if interrupts needed to be enabled in FREERTOS, but they were already enabled. I also tried to changing between falling edge and rising edge interrupts, but that didn't change anything. My first iteration of code, didn't use a queue, but I found that if you try and use printf in the interrupts it will crash because of its asynchronous nature. So, that is what the queue is for in the code below. Again, though, this code doesn't work, so I am trying to get it to work in the next work session. The code can be seen below.</li>
				<ul>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\PIR2.png" class="picture"></img> 
						<br>
						PIR sensor with interrupts code (doesn't work) PT1
					</div>
				</ul>
				<ul>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\PIR3.png" class="picture"></img> 
						<br>
						PIR sensor with interrupts code (doesn't work) PT2
					</div>
				</ul>
			</ul>
			
			<hr>

			<b>Date Reported:</b> 2/10/24<br>
            <b>Start Time:</b> 1:00 PM<br>
            <b>Work Time:</b> 4 hours<br>
			<ul class="progress">
				<li>I then decided to work on the state control in the esp code. The code I snipped above already has part of this new code. This new code is pretty scattered, so I won't show any screenshots, but I'll explain it instead. There are only two states currently: manual control (state 0) and scanning for movement (state 1). If its in state 0, it will send requests through the websocket to request for the motor direction. If it is state 1, then it will turn on the stepper motor control and send requests through the websocket for whether movement was detected or not (will talk about websocket code later in this section). When we get our third state, replay mode, the scanning mode will turn on every x amount of seconds automatically. So, to prepare for that, I made it so that every 60 seconds, the scanning state is turned on for 20 seconds, and then goes back to manuual control mode. In the final design, manual control mode will never be interruped by scanning mode, but again, this is just to prepare for the functionality that will be used when replay mode is implemented.</li>
				<li>Like I said, there were a lot of small changes in the esp code for this section, so to encompass all the little changes, the current esp code is attacked below.</li>
				<ul>
					<li><a href="Team\progress\img - member3\micro210.txt" target="__blank">ESP code up to this point</a></li>
				</ul>
				<li>I then worked on the webserver and websocket more by adding in a stop button to the display and its respective websocket.</li>
				<ul>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\stop.png" class="picture"></img> 
						<br>
						Stop button
					</div>
				</ul>
				<ul>
					<li>Below is the websocket code for the stop button</li>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\stop2.png" class="picture"></img> 
						<br>
						Websocket code for the stop button
					</div>
				</ul>
				<li>I also added in the stop button to the esp code, but since that was a small change, you can just see that in the text file linked above (ESP code up to this point)</li>
				<li>I then worked on modifying the websocket and frontend code to read in from the microcontroller whenever there is motion detected and storing the time it was detected and then displaying that in the message box. The code to do all this can be seen below.</li>
				<ul>
					<li>This code is the websocket code for receiving whether there was movement detected. It then sends the time it was recorded to another function which will be below this.</li>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\movement1.png" class="picture"></img> 
						<br>
						Websocket code for receiving movement detection data
					</div>
				</ul>
				<ul>
					<li>This code is backend code for storing the time movement was recorded in the apiData.txt file. It appends it to a list of 20 element so it keeps the 20 most recent times motion was recorded.</li>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\movement2.png" class="picture"></img> 
						<br>
						Backend code for recording movement detection time
					</div>
				</ul>
				<ul>
					<li>This code is the websocket code to clear the movement detection log for when the esp is reset. (I also implemented this in the esp code, but again, is a small change)</li>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\movement3.png" class="picture"></img> 
						<br>
						Websocket code for resetting movement detecion log
					</div>
				</ul>
				<ul>
					<li>This code is for displaying the movement detection logs to the frontend in the message box</li>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\movement4.png" class="picture"></img> 
						<br>
						Frontend code for displaying movement detection log
					</div>
				</ul>
				<ul>
					<li>And finally all this cultivates to the frontend displaying the correct times movement was detected when the right state was on (state 1) which is when the stepper motor is turning.</li>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\movement5.png" class="picture"></img> 
						<br>
						Message box displaying correct times for movement detection
					</div>
				</ul>
			</ul>

			<hr>

			<b>Date Reported:</b> 2/10/24<br>
            <b>Start Time:</b> 12:00 AM<br>
            <b>Work Time:</b> 4 hours<br>
			<ul class="progress">
				<li>
					I began working on getting the stepper motor working. I actually had a stepper motor with me along with the IC for the motor driver and they run on 5v which was perfect for this application, so I decided to use them. 
					<ul>
						<div class="visualCaption">
							<img src="Team\progress\img - member3\stepper.png" class="picture"></img> 
							<br>
							Stepper motor being used (28BYJ-48)
							<a class="references" href="https://www.adafruit.com/product/858">Image reference</a>
						</div>
					</ul>
					<li>The IC used for the stepper motor is the ULN2003A. So, I wired this up using the following driver pinout.</li>
					<ul>
						<div class="visualCaption">
							<img src="Team\progress\img - member3\stepper2.png" class="picture"></img> 
							<br>
							Stepper motor driver pinout (ULN2003A)
							<a class="references" href="https://www.digikey.com/en/products/detail/stmicroelectronics/ULN2003A/599603s">Image reference</a>
						</div>
					</ul>
					<li>To control the direction and stage of the stepper motor using the correct signals, I followed the following table to correctly control the motor.</li>
					<ul>
						<div class="visualCaption">
							<img src="Team\progress\img - member3\stepper3.png" class="picture"></img> 
							<br>
							Stepper motor driver pinout (ULN2003A)
							<a class="references" href="https://www.digikey.com/en/products/detail/stmicroelectronics/ULN2003A/599603s">Image reference</a>
						</div>
					</ul>
					<li>I then tested the motor, driver, wiring, and table by running the following code on an arduino nano and it worked correctly.</li>
					<ul>
						<li><a href="Team\progress\img - member3\stepper.txt" target="__blank">Arduino code for stepper motor</a></li>
					</ul>
					<li>Since, everything was working right on the Arduino, I then transferred to trying to get it working on the esp in the esp-idf environment. I wrote the following code to do this.</li>
					<ul>
						<li>The below code is initializing the GPIO pins for the stepper driver</li>
						<div class="visualCaption">
							<img src="Team\progress\img - member3\stepper4.png" class="picture"></img> 
							<br>
							Stepper driver GPIO initialization
						</div>
					</ul>
					<ul>
						<li>The below code is part 1 of controlling the signals for phases of the motor</li>
						<div class="visualCaption">
							<img src="Team\progress\img - member3\stepper5.png" class="picture"></img> 
							<br>
							Part 1 of motor phase control
						</div>
					</ul>
					<ul>
						<li>The below code is part 2 of controlling the signals for phases of the motor</li>
						<div class="visualCaption">
							<img src="Team\progress\img - member3\stepper6.png" class="picture"></img> 
							<br>
							Part 2 of motor phase control
						</div>
					</ul>
					<ul>
						<li>The below code the task that calls the phase control code</li>
						<div class="visualCaption">
							<img src="Team\progress\img - member3\stepper7.png" class="picture"></img> 
							<br>
							Phase control task creation
						</div>
					</ul>
				</li>
				<li class="issues">One difficult issue I ran into when writing this code was getting the delay to work. The arduino code worked fine with the 1 millisecond delay. However, when I did the 1 millisecond delay in the esp-idf env. it kept crashing and giving the following error: E (5316) task_wdt: Task watchdog got triggered. The following tasks/users did not reset the watchdog in time:
					E (5316) task_wdt:  - IDLE (CPU 0)
					E (5316) task_wdt: Tasks currently running:
					E (5316) task_wdt: CPU 0: stepper
					E (5316) task_wdt: CPU 1: IDLE
					E (5316) task_wdt: Print CPU 0 (current core) backtrace
					
					
					Backtrace: 0x4200B34E:0x3FC921C0 0x4200B4FA:0x3FC921E0 0x40376D09:0x3FC92200 0x4037B40A:0x3FC9B1B0 0x42008611:0x3FC9B1D0 0x4037BEB1:0x3FC9B1F0
					0x4200b34e: task_wdt_timeout_handling at C:/Users/mgher/esp/esp-idf/components/esp_system/task_wdt/task_wdt.c:461 (discriminator 3)
					
					0x4200b4fa: task_wdt_isr at C:/Users/mgher/esp/esp-idf/components/esp_system/task_wdt/task_wdt.c:585
					
					0x40376d09: _xt_lowint1 at C:/Users/mgher/esp/esp-idf/components/freertos/FreeRTOS-Kernel/portable/xtensa/xtensa_vectors.S:1240
					
					0x4037b40a: vTaskDelay at C:/Users/mgher/esp/esp-idf/components/freertos/FreeRTOS-Kernel/tasks.c:1677
					
					0x42008611: stepper at C:/Users/mgher/Documents/GitHub/477Grp2/antenna/main/antenna_switch_example_main.c:403
					
					0x4037beb1: vPortTaskWrapper at C:/Users/mgher/esp/esp-idf/components/freertos/FreeRTOS-Kernel/portable/xtensa/port.c:162
				</li>
				<li>One thing I tried to get around the previous issue was by turning the delay down to 10 milliseconds, but this caused the motor turn really slow and vibrate a lot, and I am pretty sure that was bad for the motor and the speed wasn't optimal either. So, I kept trying to find another solution. One thing I found was that FreeRTOS sets the default threshold to be 10 ms, so I had to go into the configuration and raise this up to allow for 1000 ticks a second. This was done by doing the following</li>
				<ul>
					<li>idf.py menuconfig</li>
					<li>Component config > FreeRTOS > Tick Rate (Hz)</li>
					<li>Change 100 to 1000</li>
				</ul>
				<li>After all this, the stepper motor with the esp finally worked!</li>
			</ul>

			<hr>

			<h1>WEEK 5</h1>
			<h4>Time spent this week: 10.5</h4>
			<hr>

			<b>Date Reported:</b> 2/7/24<br>
            <b>Start Time:</b> 3:30 PM<br>
            <b>Work Time:</b> 2.5 hours<br>
			<ul class="progress">
				<li>I tested whether the sonar sensor itself was actually broken by running the code that was given in the datasheet for the sensor for an Arduino. From this testing, I found that the sensor itself was not actually working. The code to test this in Arduino is as below.</li>
				<ul>
					<li><a href="Team\progress\img - member3\arduinoSonar.txt" target="__blank">Arduino code for sonar</a></li>
				</ul>
				<li>Because we concluded the sonar does not work, we pivoted to trying to use an ultrasonic sensor instead. This is because we looked at the datasheet for the ultrasonic sensors we have (HCSR04) and it says they have a range of 12 feet which should be good enough.</li>
				<ul>
					<li>The below code is for the esp to interface with the ultrasonic sensor</li>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\ultrasonic.png" class="picture"></img> 
						<br>
						Ultrasonic sensor code
					</div>
					<li>We were able to get pretty accurate data from the ultrasonic sensor as seen below</li>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\ultrasonic2.png" class="picture"></img> 
						<br>
						Ultrasonic sensor data
					</div>
					<li>However, the issue is that it stopped collecting data at around 3 feet which is definitely too small of a range</li>
				</ul>
				<li>We decided to pivot by instead using a pir sensor and a stepper motor. We will attach the pir sensor to the motor. This will allow us to turn the motor and read from the sensor so we can get a full 360 read with only one sensor. Additionally, the sensor is different from the sonar/ultrasonic because it only reads in a digital value of whether there is movement or not, so this more feets our need since we are only looking for movement anyway.</li>
			</ul>

			<hr>

			<b>Date Reported:</b> 2/4/24<br>
            <b>Start Time:</b> 12:00 AM<br>
            <b>Work Time:</b> 2.5 hours<br>
			<ul class="progress">
				<li>I added the code for the micro to connect with the websocket so that the sonar sensor data is recorded and is sent to the webserver</li>
				<ul>
					<li>The below code is for sending the data from the micro the websocket</li>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\sonar2.png" class="picture"></img> 
						<br>
						Sonar Sensor micro to websocket code
					</div>
				</ul>
				<ul>
					<li>This code is for adding the collected data in the websocket to an array in the apiData text file. It stored the 20 most recent measurements and shifts out the oldest measurement</li>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\sonar3.png" class="picture"></img> 
						<br>
						Websocket code for storing measurement
					</div>
				</ul>
				<ul>
					<li>This code is for looping through the stored measurements array and determines if there is a change in recorded distance. The point of the inital search up until a -1 val is so that when the sonar sensor begins recording at a new spot it doesn't think the change in the distance is due to movement since if its recording in a new spot the last distance from the old location will still be stored and will most likely not be equal to the distance at the new spot.</li>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\sonar4.png" class="picture"></img> 
						<br>
						Websocket code for determining movement
					</div>
				</ul>
			</ul>
			<ul class="issues">
				<li>When looking at the sonar sensor data today, it seems that it is not working correctly. The recorded distance is not at all accurate and seems completely random. I thought yesterday when I was working on this I got it to work, but I didn't do extensive testing, so there is a chance it was never actually working and instead my small bits of testing just led to coincidental data that seemed correct.</li>
				<li>To try and debug whether the I2C code was the issue, one thing I tried was changing the default address of the peripheral which you can see the values to do this in the figure titled "Sonar Sensor I2C key for addresses". This didn't seem to do anything and the values were still random. This result didn't really provide more information on what the issue was.</li>
				<li>One other thing I did to try and debug was change the frequencies of data transmission for I2C, but this didn't change anything.</li>
				<li>Because nothing seemed to be helping the debugging process, I think the next logical step is to try and prototype this with an Arduino and see if Arduino code can interface with it which should be easier. If that ends up not working either, then I'm just going to suggest that the sensor is problematic and we try a different one. If it doesn't work, I'll try another approach with the esp code.</li>
			</ul>

			<hr>

			<b>Date Reported:</b> 2/2/24<br>
            <b>Start Time:</b> 10:30 PM<br>
            <b>Work Time:</b> 5.5 hours<br>
			<ul class="progress">
				<li>I began working more on the getting the microcontroller to communicate with the sonar sensor with I2C communicated protocol.</li>
				<li>
					This is from the sonar sensor documentation and is helpful for knowing what data to send to the sensor over I2C to write and read and also for what the default address is.
					<div class="visualCaption">
						<img src="Team\progress\img - member3\sonar1.png" class="picture"></img> 
						<br>
						Sonar Sensor I2C key for addresses
					</div>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\sonar0.png" class="picture"></img> 
						<br>
						Sonar Sensor I2C key for reading and writing
					</div>
					<ul class="references">
						<li><a href="https://maxbotix.com/pages/i2cxl-maxsonar-ez-datasheet">https://maxbotix.com/pages/i2cxl-maxsonar-ez-datasheet</a></li>
					</ul>
				</li>
				<li class="issues">The first way I went about it, I used the code attached below in the text file which didn't end up working.</li>
				<ul>
					<li><a href="Team\progress\img - member3\i2cdidntwork1.txt" target="__blank">Problematic I2C sonar code 1</a></li>
					<li>This code was successfully able to retrieve the address of the sonar peripheral which is necessary in order to communicate with the sensor (it was 0x70 for this sensor)</li>
					<li>This code was also apparently (according to the return statuses) able to communicate with the sensor on the given address, but when the correct data was sent to begin a reading on the sensor, it never was able to successfuly able to read anything. So, it was impossible to really tell if the writing or the reading was the problem.</li>
				</ul>

				<li class="issues">The second way I went about it, I used the code attached below in the text file which also didn't end up working.</li>
				<ul>
					<li><a href="Team\progress\img - member3\i2cdidntwork2.txt" target="__blank">Problematic I2C sonar code 2</a></li>
					<li>This code was not able to successfully accomplish anything. It returned an error code on both the writing and reading.</li>
				</ul>

				<li> The code below actually worked! (and of course its the most simple too)</li>
				<ul>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\i2c2.png" class="picture"></img> 
						<br>
						I2C initalization code for sonar sensor
					</div>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\i2c3.png" class="picture"></img> 
						<br>
						I2C setup code for sonar sensor
					</div>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\i2c1.png" class="picture"></img> 
						<br>
						I2C write and read code for sonar sensor
					</div>
				</ul>
				<li class="todo">Still to do:</li>
				<ul class="todo">
					<li>Add state for scanning in micro code.</li>
					<li>Add webhook code for collecting sonar data</li>
				</ul>
			</ul>


			<h1>WEEK 4</h1>
			<h4>Time spent this week: 10.25</h4>
			<hr>

			<b>Date Reported:</b> 01/31/24<br>
            <b>Start Time:</b> 3:30 PM<br>
            <b>Work Time:</b> 2.5 hours<br>
			<ul class="progress">
				<li>Met with team to discuss PSDRs and progress with proffesor and TA. Based on this discussion, everything is okay right now, but we are going to slightly modify the word choice on a PSDR. Also worked on our component analysis assignment which can be seen below.</li>
				<ul>
					<li><a href="Team\progress\img - member3\A5 - Component Analysis Template.docx.pdf" target="__blank">Component Analysis</a></li>
				</ul>
				<li>Began to research how to communicate with the sonar sensor from the esp-idf using I2C. I have found that this resource contains valuable documentation.</li>
				<ul class="references">
					<li><a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/peripherals/i2c.html">https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/peripherals/i2c.html</a></li>
					<li><a href="https://github.com/espressif/esp-idf/blob/master/examples/peripherals/i2c/i2c_tools/README.md">https://github.com/espressif/esp-idf/blob/master/examples/peripherals/i2c/i2c_tools/README.md</a></li>
				</ul>
			</ul>
			
			<hr>			

			<b>Date Reported:</b> 01/30/24<br>
            <b>Start Time:</b> 9:00 PM<br>
            <b>Work Time:</b> 0.75 hours<br>
			<ul class="progress">
				<li> I have added the frontend capabilities for displaying messages on the user interface along with a few other interface changes. These messages will eventually be for displaying things like the motion detection messages and possibly other types of messages in the future if time permits (some ideas are, battery level warnings, or the current state of the robot). </li>
				<ul>
					<li>
						Most of these changes were just some simple html and css changes, so no point in showing that. But here is the new interface. As of right now, it just takes in any return messages from a specific websocket endpoint and appends those messages to an array, and then displays the contents of the array in the box.
						<div class="visualCaption">
							<img src="Team\progress\img - member3\message3.png" class="picture"></img> 
							<br>
							New MOUSE interface with message box
						</div>
					</li>
				</ul>
			</ul>
			<hr>

			<b>Date Reported:</b> 01/28/24<br>
            <b>Start Time:</b> 3:30 AM<br>
            <b>Work Time:</b> 0.5 hours<br>
			<ul class="progress">
				<li> I have added speed capabilities to the UI, websocket, and micro with the code below</li>
				<ul>
					<li>
						Below is the code for the websocket backend to increase the stored speed in the apiData text file. Each time the button is clicked on the UI, the speed increases until the user clicks a new button and then it resets to a speed of 1.
						<div class="visualCaption">
							<img src="Team\progress\img - member3\speed.png" class="picture"></img> 
							<br>
							Speed control websocket code
						</div>
					</li>
					<li>
						Below is the code for the microcontroller which parses through the response to the motor speed and direction request. It retrieves both the speed and direction.
						<div class="visualCaption">
							<img src="Team\progress\img - member3\speed2.png" class="picture"></img> 
							<br>
							Motor speed and direction request response microcontroller code
						</div>
					</li>
				</ul>
			</ul>

			<hr>

			<b>Date Reported:</b> 01/28/24<br>
            <b>Start Time:</b> 11:45 AM<br>
            <b>Work Time:</b> 0.75 hours<br>
			<ul class="progress">
				<li> I began to clean up and modularize the code for the micro code a little. This led me to also implementing the shell of the code for the motor control on the micro. The motor control requests work very similarly to the previous code I have outlined for the LED control. For now, a request for getting the motor direction is just being sent in parallel to the LED control, but soon it will only send one type of request at a time given the provided state by the user. The code I have written so far is as follows:</li>
				<ul>
					<li>
						Below is the code for the micro to receive incoming data from a websocket request and decide which direction the motors should be driving in
						<div class="visualCaption">
							<img src="Team\progress\img - member3\motor2.png" class="picture"></img> 
							<br>
							Motor request direction code
						</div>
					</li>
					<li>
						Below is the updated websocket code to handle incoming requests for motor control
						<div class="visualCaption">
							<img src="Team\progress\img - member3\motor1.png" class="picture"></img> 
							<br>
							Motor request websocket code
						</div>
					</li>
					<li class="todo">Still to do:</li>
					<ul class="todo">
						<li>Add speed to requests and interface.</li>
						<li>Add state so that requests aren't being sent for LEDs and motors at same time.</li>
					</ul>
				</ul>
			</ul>

			<hr>

			<b>Date Reported:</b> 01/28/24<br>
            <b>Start Time:</b> 12:15 AM<br>
            <b>Work Time:</b> 3 hours<br>
			<ul class="progress">
				<li>I worked on getting the status of the microcontroller to be accurately stored on the websocket which wasn't currently working. Last week, Braden and I tried to do this by storing the connection persistently in a variable in the websocket file. However, we figured out there is no good way to store a variable persistently in the websocket file. My first idea was to do a really bad bandaid fix by just checking if the number of clients is 1 and use the assumption that if there is only 1 client on then it is the webserver client, but I really hated that idea. So, I decided we would do this the same way we are controlling the micro peripherals like the LED and store it in the apiData text file. The way this works is when the micro connects to the websocket sends a specific connection message every few seconds (made it every few seconds so it doesnt impact the latency of other requests too much). Then on the websocket server, the time this request is received is stored in the apiData text file. Then when the webserver refreshes it sends a websocket request to retrieve the time being stored for micro connection status. If the time is more than 10 seconds from the current time, then it displays that the micro is not connected and says it is connected otherwise. The code below will show this in greater detail.</li>
				<ul>
					<li>
						Below is the code that the micro sends where you can see every 5 iterations it sends a request telling the websocket it is still connected
						<div class="visualCaption">
							<img src="Team\progress\img - member3\connect.png" class="picture"></img> 
							<br>
							Maintained connection esp code
						</div>
					</li>
					<li>
						Below is the websocket code that retrieves the request from the micro that it is still connected and calls a backend function that logs the time in the text file
						<div class="visualCaption">
							<img src="Team\progress\img - member3\connect3.png" class="picture"></img> 
							<br>
							Maintained connection websocket code
						</div>
					</li>
					<li>
						Below is the websocket code that retrieves the request from the webserver and looks in the text file and lets the webserver know if the most recent call from the micro was within the last 10 seconds
						<div class="visualCaption">
							<img src="Team\progress\img - member3\connect3.png" class="picture"></img> 
							<br>
							Time since last connection websocket code
						</div>
					</li>
					<li>
						Below is the backend code that stores a given value in a given row in the text file, in this case its being used to store the time for a micro connection
						<div class="visualCaption">
							<img src="Team\progress\img - member3\connect4.png" class="picture"></img> 
							<br>
							Store value in text file code
						</div>
					</li>
				</ul>
				<li>
					I also continued Braden's CSS efforts as seen below.
					<div class="visualCaption">
						<img src="Team\progress\img - member3\css.png" class="picture"></img> 
						<br>
						New MOUSE homepage
					</div>
				</li>
			</ul>

			<hr>

			<b>Date Reported:</b> 01/27/24<br>
            <b>Start Time:</b> 12:15 AM<br>
            <b>Work Time:</b> 2.75 hours<br>
			<ul class="progress">
				<li>I worked on getting the shift register daisy chain LED circuit to work with the ESP.</li>
				<ul>
					<li>I ran into some problems here, so unfortunately, I remade the circuit on my own breadboard.</li>
					<li>After some quick tests, I found the new circuit worked.</li>
					<li>I then went on to write the code to control it.</li>
					<ul>
						<li>
							Below is the initialization of the pins and a macro that will be helpful for setting the output bits
							<div class="visualCaption">
								<img src="Team\progress\img - member3\SR.png" class="picture"></img> 
								<br>
								Initialization Pins/Macro for Shift Register Daisy Chain Code
							</div>
						</li>
						<li>
							Below is the setup for the GPIO pins (latch, data, clock)
							<div class="visualCaption">
								<img src="Team\progress\img - member3\SR2.png" class="picture"></img> 
								<br>
								Shift Register GPIO Pin Setup
							</div>
						</li>
						<li>
							Below is the function I used to replicate the Arduino Shiftout function which shifts out a binary number to the data pin using the clock and latch pins
							<div class="visualCaption">
								<img src="Team\progress\img - member3\SR3.png" class="picture"></img> 
								<br>
								ShifOut function for ESP
							</div>
						</li>
						<li>
							Below is the code we will use to control certain segments of our 24 LED array given a lower and upper index range
							<div class="visualCaption">
								<img src="Team\progress\img - member3\SR4.png" class="picture"></img> 
								<br>
								SetLEDRange function
							</div>
						</li>
						<li>
							Below is some example code of how to use all of the code above. This example turns on the 8 green LEDs when the webhook receives a specific response and the 8 yellow LEDs when the webhook receives a different response.
							<div class="visualCaption">
								<img src="Team\progress\img - member3\SR5.png" class="picture"></img> 
								<br>
								Shift Register ESP Example Use Case Code
							</div>
						</li>
					</ul>
				</ul>
				<li class="think">I also found that the type of WiFi seems to change the throughput threshold for thw webhook requests. Last week, I got the webhook frequency to be ~0.5 seconds and that was when I was connected to my mobile hotspot. However, when I connected to my local WiFi today, I found it was struggling to maintain that frequency and had to be brought down to around ~5 seconds. So, that brings me to believe the type of WiFi matters or at least the type of WiFi connection matters. From now on, all testing will be done on a hotspot unless we find a way to make the connection to a local WiFi the same as the connection to a mobile hotspot between the ESP. </li>
			</ul>


			<h1>WEEK 3</h1>
			<h4>Time spent this week: 15.25</h4>
			<hr>

			<b>Date Reported:</b> 01/25/24<br>
            <b>Start Time:</b> 12:00 PM<br>
            <b>Work Time:</b> 4 hours<br>
			<ul class="progress">
				<li>I worked on the software overview assignment. You can view it with the link below</li>
				<ul>
					<li><a href="Team\progress\img - member3\A3 - Software Overview Template.pdf" target="__blank">Software Overview</a></li>
				</ul>
			</ul>

			<b>Date Reported:</b> 01/24/24<br>
            <b>Start Time:</b> 3:30 PM<br>
            <b>Work Time:</b> 2.5 hours<br>
			<ul class="progress">
				<li>Tried to connect the esp to PAL3.0 and eduroam wifi and had some difficulties so found that connecting to a hotspot is probably the way to get around this from this point on.</li>
				<li>Braden updated some of the webhook endpoints and changed the naming scheme around by adding square brackets and I noticed that change caused the lag to increase by a decent amount. This led me to think maybe the length of the data being sent through the websocket is a factor in the lag. Because of this, I tried decreasing the data being sent in each websocket request and found I could get the lag to <= 0.5 seconds which is a big improvement from the previous <= 2 seconds. </li>
				<ul>
					<li>I continued this development by decreasing the data for the rest of the websocket requests from the microcontroller.</li>
					<li>I also added in an initial request from the microcontroller that tells the websocket that the microcontroller specifically connected because the websocket doesn't inherently know what device each connection is from.</li>
				</ul>
				<li class="issues">I also tried to help Braden a little to try and display the microcontroller connection status to the webpage. We were running into some issues as the status kept coming back as not connected even when the microcontroller was indeed connected. My hypothesis for why this is is because I think the variables (even when global) in our websocket are not persistent because I know that regular api endpoint variables are not persistent. The weird thing is is that there is another endpoint that Braden made that keeps track of all the clients connected and sends each of them a message, and that works fine, so it seems that some variables can be persistent. One work around that we can do in the future for this is just storing the microcontroller connection status in the apiData.txt file that we keep other variables we want to be persistent like the ledStatus or the moving instructions.</li>
			</ul>

			<hr>

			<b>Date Reported:</b> 01/21/24<br>
            <b>Start Time:</b> 2:00 AM<br>
            <b>Work Time:</b> 0.5 hours<br>
			<ul class="progress">
				<li>I was able to get the lag to be <=2 seconds. The code below is the code that allows for this decrease in lag</li>
				<ul>
					<div class="visualCaption">
						<img src="Team\progress\img - member3\microcontroller3.png" class="picture"></img> 
						<br>
						Updated Microcontroller Websocket Code for Decreased Lag
					</div>
					<li class="issues">I believe the issue was a throughput issue that the ESP32 has when using TCP. I have found that when the delay between sending messages goes below 1.5 seconds, it causes the long delay to occur, so for now it will remain at 1.5 seconds unless I find a workaround. However, up to 2 seconds of delay shouldn’t be too big of a deal as long as the robot is controlled with a low speed.</li>
				</ul>
			</ul>

			<hr>

			<b>Date Reported:</b> 01/20/24<br>
            <b>Start Time:</b> 8:30 PM<br>
            <b>Work Time:</b> 4 hours<br>
			<ul class="progress">
				<li>To get around the error I ended up seeing in the last progress section, I implemented the following code which handles connecting to the wifi:</li>
				<div class="visualCaption">
					<img src="Team\progress\img - member3\microcontroller.png" class="picture"></img>
					<br>
					Wifi Connection Microcontroller Code 
				</div>
				<li>Once the wifi connection was working, I was able to test the websocket connection with the microcontoller and it worked as seen below</li>
				<div class="visualCaption">
					<img src="Team\progress\img - member3\microcontroller2.png" class="picture"></img>
					<br>
					Websocket Successful Connection Output
				</div>
				<li class="issues">The issue I spent hours trying to figure out and searching around for online was to do with the following:</li>
				<ul class="issues">
					<li>A strange behavior was occurring where the microcontroller would be able to send about a request or two per second (as expected). Then after a few seconds it would stop, it would then wait for ~4 seconds and this would sometimes be double or triple that time. Then it would send a whole load of requests (20-30) and then start sending a request or two per second again… and then of course repeat the cycle. This means that there is a very inconsistent data travel time which leads to sometimes around 8-12 seconds of delay which is a big problem since we were planning on using the websocket to receive data when to move forward, left, right, etc.</li>
					<li>		○ Another interesting piece of information is that sometimes (not always, but the majority of the time) the ~4 second delays would be accompanied by the following message:  
						W (24808) wifi:[ADDBA]rx delba, code:39, delete tid:0 I (24808) wifi:ba-delidx:0, tid:0 I (25548) wifi:ba-addidx:0 (ifx:0, 10:be:f5:1b:89:c4), tid:0, ssn:64, winSize:64 I (25548) wifi:ba-delidx:0, tid:0 I (25558) wifi:ba-addidx:0 (ifx:0, 10:be:f5:1b:89:c4), tid:0, ssn:65, winSize:64</li>
					<ul>
						<li>I was not able to find any information or other people talking about this online so I became stuck at this point (however, it seems like it could be a throughput issue because of this warning message) and I am now considering not controlling the movement (which highly depends on low latency) with the websocket and instead possibly with RF</li>
					</ul>
				</ul>
			</ul>

			<hr>

			<b>Date Reported:</b> 01/20/24<br>
            <b>Start Time:</b> 5:15 PM<br>
            <b>Work Time:</b> 0.75 hours<br>
			<ul class="progress">
				<li>Started development on webhook implementation on the microcontroller to replace the api implementation</li>
				<ul>
					<li class="references">The following is the documentation for the websocket library for esp-idf: https://docs.espressif.com/projects/esp-idf/en/v4.1/api-reference/protocols/esp_websocket_client.html</li>
					<li class="instructions">You have to manually add this dependency through the esp-idf terminal as follows:  idf.py add-dependency "espressif/esp_websocket_client^1.0.0"</li>
					<li>I also added the webhook for the backend server to retrieve the file contents and return them which is what the microcontroller will use to retrieve io status</li>
					<li class="issues">When trying to connect to the wifi with the example code in esp-idf I was getting the following error: assert failed: tcpip_send_msg_wait_sem /IDF/components/lwip/lwip/src/api/tcpip.c:449 (Invalid mbox)</li>
				</ul>
			</ul>

			<hr>

			<b>Date Reported:</b> 01/20/24<br>
            <b>Start Time:</b> 2:00 PM<br>
            <b>Work Time:</b> 1.5 hours<br>
			<ul class="progress">
				<li>Decided to take a different route by using an express websocket instead of a vue websocket because I couldn't find a solution the error in the last progress section.</li>
				<li>That ended up working and I got the frontend to communicate to the backend and do the toggle light script from last week working, so when the user presses the button it hits the websocket and changes the text in the status text folder and flips the light on or off.</li>
				<li>The frontend code looks as follows:</li>
				<div class="visualCaption">
					<img src="Team\progress\img - member3\frontend.png" class="picture"></img>
					<br>
					Frontend Websocket Code 
				</div>
				<ul>
					<li>Another pro of switching to a web socket is it actually makes the frontend code a lot more simple and all that is needed is an initial websocket connection, send a message to the websocket whenever necessary, and record the return data. Later on, there may need to be some logic added to handle reconnections if that becomes a problem.</li>
				</ul>
				<li>The backend code looks as follows:</li>
				<div class="visualCaption">
					<img src="Team\progress\img - member3\backend.png" class="picture"></img>
					<br>
					Websocket Initial Backend Code
				</div>
				<ul>
					<li>This code is similar to the frontend code but obviously in the backend. So all that is needed is to handle any incoming connections and then anytime is gets a message to begin any necessary scripts and send back any return data. And then also to handle client disconnections. Like I said in the frontend portion, we may need to handle reconnections later on if that becomes a problem later on.</li>
				</ul>
				<li>From the frontend connection, this code already seems a little faster. However, frontend wasn’t having a speed problem with the previous API implementation, so the microcontroller connection is what will really tell if this change was helpful or not.</li>
			</ul>

			<hr>

			<b>Date Reported:</b> 01/20/24<br>
            <b>Start Time:</b> 11:15 AM<br>
            <b>Work Time:</b> 1 hour<br>
			<ul class="progress">
				<li class="references">This resource will be helpful for dealing with the web socket requests on the microcontroller, specifically the persistent http request section</li>
				<ul class="references">
					<li>https://docs.espressif.com/projects/esp-idf/en/latest/esp32s3/api-reference/protocols/esp_http_client.html</li>
				</ul>
				<li>Frontend Dev</li>
				<ul>
					<li>Tried to use vue websocket library as our websocket for both frontend and backend on our webserver</li>
					<li>npm install vue-native-websocket</li>
					<li class="issues">Ran into following error</li>
					<ul class="issues">
						<li>Error in mounted hook: TypeError: vue_native_websocket__WEBPACK_IMPORTED_MODULE_0___default(...) is not a function</li>
					</ul>
				</ul>
			</ul>

			<hr>

			<b>Date Reported:</b> 01/20/24<br>
            <b>Start Time:</b> 1:00 AM<br>
            <b>Work Time:</b> 1 hour<br>
			<ul class="issues">
				<li>Shortened delays between API as much as possible and tried to make calls more efficient but was still experiencing a lot of latency</li>
				<li>I looked at where it was getting stuck and the issue is that closing the socket connection was causing most of the latency</li>
				<li>I think I am going to try and use a webhook instead because we wont have to reopen and close the socket connection with a websocket so it should speed up the process</li>
			</ul>


			<br>
			<h1>WEEK 2</h1>
			<h4>Time spent this week: 12.75</h4>
			<hr>
			<b>Date Reported:</b> 01/17/24<br>
            <b>Start Time:</b> 3:30 PM<br>
            <b>Work Time:</b> 2 hours<br>

			<ul class="progress">
				<li>
					Started and finished functional specification assignment as a team.
					<ul>
						<li><a href="Team\progress\img - member3\A2 - Functional Specification Template.docx.pdf" target="__blank">Download functional specification doc</a></li>
					</ul>
				</li>
				<li>
					Reworked our PSDRs which can be seen on our team homepage or as seen below.
					<ul>
						<li><img src="Team\progress\img - member3\Screenshot 2024-01-18 205211.png" class="picture"></img></li>
					</ul>
				</li>
			</ul>

			<hr>

			<b>Date Reported:</b> 01/15/24<br>
            <b>Start Time:</b> 1:30 AM<br>
            <b>Work Time:</b> 1.5 hours<br>
			<ul class="progress">
				<li>
					Updated the API endpoint to toggle the light to write and read to a local file on the ec2 instance instead of an RDS because it seems there is no free solution with the RDS. So, the API endpoint to toggle the LED now reads from a local apiData text file and updates the value accordingly.
				</li>
				<li>
					Added another endpoint to read from the file which is what the microcontroller will use. The functionality of this endpoint is to read from the local text file and parse to get the value of the LED status, and then return it to the microcontroller. 
				</li>
				<li>
					I integrated the call to the new reading light api endpoint to the http requests microcontroller code and added in code to check if the value returned corresponds to an on or off led. I also added the code to control an external LED for the microcontroller.
				</li>
				<li>
					I finally tested all of this integrated together by pushing the toggle button on the web server and the light successfully toggled in real life, so it worked. Below you can see the webpage turned on the light.
				</li>
				<li>
					<img src="Team\progress\img - member3\api3.png" class="picture"></img>
				</li>
				<li>
					<img src="Team\progress\img - member3\light.jpg" class="picture"></img>
				</li>
			</ul>


			<hr>


			<b>Date Reported:</b> 01/14/24<br>
            <b>Start Time:</b> 7:00 & 10:15 PM<br>
            <b>Work Time:</b> 1.5 hours<br>
			<ul>
				<li class="progress">
					Installed vue
					<ul>
						<li>
							Frontend framework for our webserver
						</li>
						<li>
							Npm install -g @vue/cli
						</li>
					</ul>
				</li>
				<li class="progress">
					Created vue project
					<ul>
						<li>
							Vue create mouseui
						</li>
					</ul>
				</li>
				<li class="progress">
					Made simple page to toggle light
					<ul>
						<li>
							<img src="Team\progress\img - member3\web.png" class="picture"></img>
						</li>
						<li>
							What this will do is hit the API endpoint for turning on a light. That API endpoint will change a value locally stored. Another API endpoint will be made to check the value in the database. The ESP will constantly be hitting this API endpoint which will allow it to retrieve the value in the database. And if the value is true, it will turn on the light and if it false it will turn of the light. This is acting as a prototype for how the motor control will work and is using an LED instead for simplicity.
						</li>
					</ul>
				</li>
				<li class="instructions">
					How to update frontend code
					<ul>
						<li>
							Update code
						</li>
						<li>To run the server locally to see/test your change, run: npm run serve</li>
						<li>To build your code, run: npm run build</li>
						<li>Push to git</li>
						<li>Go onto ec2 instance and pull code w/ git</li>
						<li>Put contents of dist folder into html folder</li>
					</ul>
				</li>
				<li class="instructions">
					To start nginx server
					<ul>
						sudo systemctl start nginx
					</ul>
				</li>
			</ul>


			<hr>


			<b>Date Reported:</b> 01/14/24<br>
            <b>Start Time:</b> 4:20 PM<br>
            <b>Work Time:</b> 1.25 hours<br>
			<ul>
				<li class="progress">
					Got a prototype example script to work for sending http requests to aws api and got the right result
					<ul>
						<li>
							The code can be found here: https://github.com/cmiotto20/477Grp2/tree/main/http_request
						</li>
						<li>TLDR: The code does not connect to the WiFi and instead you have to connect to the local WiFi manually in the microcontroller configuration files (this is a temporary solution until I implement the code to connect to WiFi programatically). What this code does do is take in an IP, a port, and an endpoint name. Then it hits the API endpoint and gets back the request as a buffer. It then prints out the buffer by looping through it.</li>
					</ul>
				</li>
				<li class="progress">
					Here are the two test cases for the two current api endpoints
					<ul>
						<li>
							<img src="Team\progress\img - member3\api1.png" class="picture"></img>
						</li>
						<li>
							<img src="Team\progress\img - member3\api2.png" class="picture"></img>
						</li>
						<li>
							From these two screenshots you can see that the first API call got a 200 response which means the api returned a OK response and it got the following JSON response: "This API call was a success (as expected)"; this response is directly from the API call which shows we are retrieving the data correctly from the API endpoint. A similar result can be seen from the second screenshot, but with different data and responses to show that this works consistently with different API endpoints.
						</li>
					</ul>
				</li>
			</ul>


			<hr>


			<b>Date Reported:</b> 01/13/24 & 01/14/24<br>
            <b>Start Time:</b> 9:30 PM & 1:20 AM<br>
            <b>Work Time:</b> 2.5 hours<br>

			<ul>
				<ul class="progress">
					<li>
						Set up AWS account
					</li>
					<li>
						Invited all members of team and created admin permissions group and assigned that to each member
					</li>
					<li>
						Created EC2 instance
					</li>
				</ul>
				<ul class="instructions">
					<li>
						To ssh into EC2 instance do the following
					</li>
					<ul>
						<li>
							Keep track of where the key pair is
						</li>
						<li>
							Go into VS code and press ctrl-shift-p
						</li>
						<li>
							Type: Remote-SSH: connect to host…
						</li>
						<li>
							Configure SSH hosts
						</li>
						<li>
							Choose the right config file
						</li>
						<li>
							Add the following
							<br>
							<img src="Team\progress\img - member3\Screenshot 2024-01-14 171445.png" class="picture"></img>
						</li>
					</ul>
					<li class="progress">
						Installed NGINX
						<ul>
							<li>
								Will run our webserver
							</li>
							<li>
								Sudo yum install nginx
							</li>
						</ul>
					</li>
					<li class="progress">
						Installed git
						<ul>
							<li>
								For git control
							</li>
							<li>
								Sudo yum install git
							</li>
						</ul>
					</li>
					<li class="progress">
						Cloned github repo
						<ul>
							<li>
								sudo git clone https://github.com/cmiotto20/477Grp2
							</li>
						</ul>
					</li>
					<li class="progress">
						Installed npm
						<ul>
							<li>
								For installed nodejs libraries
							</li>
							<li>
								Sudo yum install npm
							</li>
						</ul>
					</li>
					<li class="progress">
						Installed pm2
						<ul>
							<li>
								For running our api server
							</li>
							<li>
								Sudo npm install -g pm2
							</li>
						</ul>
					</li>
					<li class="progress">
						Gave full permissions to all users to edit nginx directory where all the code will go
					</li>
					<li class="progress">
						Installed express
						<ul>
							<li>Nodejs Api library</li>
							<li>Sudo npm install -g express</li>
						</ul>
					</li>
					<li class="progress">
						Made a simple nodejs express api endpoint and tested it and it worked
					</li>
					<li class="instructions">
						How to make changes to api
						<ul>
							<li>Edit code in app.js</li>
							<li>If you want to check if it compiles, run node app.js</li>
							<li>If the api server is already running, run pm2 restart app.js</li>
							<li>If the api server is not already running, run pm2 start app.js</li>
							<li>If you need to the api server for whatever reason, run pm2 stop app.js</li>
							<li>To test it, use a curl command on port 8080 for whatever endpoint you edited</li>
						</ul>
					</li>
					<li class="progress">
						I have been attempting to find code that works for connecting to an api via http for espressif and havent had much success but did find a good way to have the esp connect to wifi for testing purposes which is as follows:
						<ul>
							<li>
								In bash, idf.py menuconfig
							</li>
							<li>
								Go to example connection configuration and input the wifi ssid and password
							</li>
						</ul>
					</li>
				</ul>
			</ul>


			<hr>


            <b>Date Reported:</b> 01/13/24<br>
            <b>Start Time:</b> 2:30 PM<br>
            <b>Work Time:</b> 4 hours<br>
			<ul>
				<li class="instructions">
					Setup and configured Espressif for esp development in vscode
					<ul>
						<li>
							Link 1: vscode-esp-idf-extension/docs/tutorial/install.md at master · espressif/vscode-esp-idf-extension
						</li>
						<li>
							Link 2: https://github.com/espressif/vscode-esp-idf-extension/blob/master/docs/tutorial/basic_use.md
						</li>
						<ul>
							<li>
								When setting device:
							</li>
							<ul>
								<li>
									Choose esp32s3
								</li>
								<li>
									Choose usb bridge option
								</li>
							</ul>
							<li>
								Do the extra c/c++ setup here: https://github.com/espressif/vscode-esp-idf-extension/blob/master/docs/C_CPP_CONFIGURATION.md
							</li>
						</ul>
					</ul>
				</li>

				<li class="instructions">
					How to update project
					<ol>
						<li>
							Update code
						</li>
						<li>
							ESP-IDF: Select port to use (COM, tty, usbserial)
						</li>
						<li>
							ESP-IDF: Build your project
						</li>
						<li>
							ESP-IDF: Flash (UART) your project
						</li>
						<li>
							ESP-IDF: Monitor your device
						</li>
					</ol>
				</li>

				<li class="references">
					Did some testing with prototyping a simple script to make the esp blink and control an external GPIO pin
					<ul>
						ESP32 S3 Pinout for references
						<br>
						<img src="Team\progress\img - member3\ESP32-S3_DevKitC-1_pinlayout_v1.1.jpg" class="picture"> </img>
						<br>
						src: https://docs.espressif.com/projects/esp-idf/en/latest/esp32s3/hw-reference/esp32s3/user-guide-devkitc-1.html
					</ul>
					<ul>
						Basic GPIO control testing
						<br>
						<img src="Team\progress\img - member3\Screenshot 2024-01-14 170854.png" class="picture"></img>
					</ul>
				</li>
			</ul>

			<br>
			<h1>WEEK 1</h1>
			<h4>Time spent this week: 2</h4>
			<hr>

			<b>Date Reported:</b> 01/10/24<br>
            <b>Start Time:</b> 3:30 PM<br>
            <b>Work Time:</b> 2 hours<br>
			<ul class="progress">
				<li>Started and finished project proposal with team</li>
				<li>Went on tour of lab</li>
				<li>Brainstormed and discussed how we would approach the project as a team. Decided on trying to use 4 ultrasonic sensors and a lidar. We also decided we would use a premade chassis but CAD and 3D print the body of the robot. We also decided we would use AWS as our web interface and have our WiFi connected microcontroller request to send and receive data to the server via an API. We also decided on our PSDRs which can be seen on our 477 website. </li>
				<li>Gathered components for project: ESP, Shift registers, Chassis, LEDs, resistors</li>
			</ul>


			<hr>

			<br
		</br>
                     
        </div>
    </div>
</div>
</body>
</html>
